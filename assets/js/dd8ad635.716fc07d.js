"use strict";(self.webpackChunkdocs_test=self.webpackChunkdocs_test||[]).push([[1644],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>h});var n=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var c=n.createContext({}),s=function(e){var t=n.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},u=function(e){var t=s(e.components);return n.createElement(c.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},g=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,i=e.originalType,c=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=s(a),g=o,h=d["".concat(c,".").concat(g)]||d[g]||p[g]||i;return a?n.createElement(h,r(r({ref:t},u),{},{components:a})):n.createElement(h,r({ref:t},u))}));function h(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=a.length,r=new Array(i);r[0]=g;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l[d]="string"==typeof e?e:o,r[1]=l;for(var s=2;s<i;s++)r[s]=a[s];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}g.displayName="MDXCreateElement"},1272:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>p,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var n=a(7462),o=(a(7294),a(3905));const i={},r="Background location access",l={unversionedId:"Point SDK/iOS/Features/Blue bar",id:"Point SDK/iOS/Features/Blue bar",title:"Background location access",description:"What is the background location usage indicator?",source:"@site/docs/Point SDK/iOS/Features/Blue bar.md",sourceDirName:"Point SDK/iOS/Features",slug:"/Point SDK/iOS/Features/Blue bar",permalink:"/documentation/Point SDK/iOS/Features/Blue bar",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"defaultSidebar",previous:{title:"App restart notification",permalink:"/documentation/Point SDK/iOS/Features/App restart notification"},next:{title:"Enable or Disable Zone",permalink:"/documentation/Point SDK/iOS/Features/Enable or disable zones"}},c={},s=[{value:"What is the background location usage indicator?",id:"what-is-the-background-location-usage-indicator",level:2},{value:"When to use the background location usage indicator?",id:"when-to-use-the-background-location-usage-indicator",level:2},{value:"How to set the background location usage indicator?",id:"how-to-set-the-background-location-usage-indicator",level:2},{value:"Background location use cases",id:"background-location-use-cases",level:2}],u={toc:s},d="wrapper";function p(e){let{components:t,...i}=e;return(0,o.kt)(d,(0,n.Z)({},u,i,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"background-location-access"},"Background location access"),(0,o.kt)("h2",{id:"what-is-the-background-location-usage-indicator"},"What is the background location usage indicator?"),(0,o.kt)("p",null,"The background location usage indicator (Blue Bar) is an iOS feature that allows an app to access location data when the user has selected While using the app location authorization and the app is in the background."),(0,o.kt)("p",null,"The background location usage indicator will be displayed as a blue pill or bar at the top of the screen \u2013 either behind the clock or across the status bar (the event display changes between iPhone models). This notification lets the user know that an app is accessing location data."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"iOS background location usage indicator",src:a(3934).Z,width:"518",height:"395"})),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"If the user has selected the ",(0,o.kt)("em",{parentName:"p"},"Always")," location authorization, the background location usage indicator will not be displayed.")),(0,o.kt)("h2",{id:"when-to-use-the-background-location-usage-indicator"},"When to use the background location usage indicator?"),(0,o.kt)("p",null,"Background location usage indicator should be enabled when usage requires location updates even when the App is running in background and the user has granted the ",(0,o.kt)("em",{parentName:"p"},"While using the app")," location authorization.\xa0"),(0,o.kt)("h2",{id:"how-to-set-the-background-location-usage-indicator"},"How to set the background location usage indicator?"),(0,o.kt)("p",null,"As per the ",(0,o.kt)("a",{parentName:"p",href:"https://developer.apple.com/documentation/corelocation/getting_the_user_s_location/handling_location_events_in_the_background"},"documentation"),", enabling the background location usage indicator first requires that the app has enabled the location updates background mode:"),(0,o.kt)("p",null,(0,o.kt)("img",{src:a(1939).Z,width:"768",height:"476"})),(0,o.kt)("p",null,"If the location updates background mode is enabled, the background location usage indicator can be enabled and disabled by setting the ",(0,o.kt)("inlineCode",{parentName:"p"},"allowsBackgroundLocationUpdates")," property from ",(0,o.kt)("a",{parentName:"p",href:"https://developer.apple.com/documentation/corelocation/cllocationmanager"},"CLLocationManager"),", which is inherited by ",(0,o.kt)("a",{parentName:"p",href:"https://ios-docs.bluedot.io/Classes/BDLocationManager.html"},"BDLocationManager"),":"),(0,o.kt)("p",null,(0,o.kt)("img",{src:a(4302).Z,width:"768",height:"96"}),"  "),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Enable background location usage indicator:")," \xa0 \xa0\xa0"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-swift"},"BDLocationManager.instance().allowsBackgroundLocationUpdates = true\n")),(0,o.kt)("p",null,"For the background location usage indicator to work, ",(0,o.kt)("inlineCode",{parentName:"p"},"allowsBackgroundLocationUpdates")," must be set to ",(0,o.kt)("inlineCode",{parentName:"p"},"true")," while the app is in the foreground, and the app has ",(0,o.kt)("em",{parentName:"p"},"While using the app")," location authorization. If ",(0,o.kt)("inlineCode",{parentName:"p"},"allowsBackgroundLocationUpdates")," is set to ",(0,o.kt)("inlineCode",{parentName:"p"},"true")," while the app is in the background, or the user changes the location permission to ",(0,o.kt)("em",{parentName:"p"},"While using the app")," while the app is in the background, the background location usage indicator will not be enabled."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Disable background location usage indicator:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-swift"},"if (BDLocationManager.authorizationStatus != .authorizedAlways) {\n\xa0 BDLocationManager.instance().allowsBackgroundLocationUpdates = false\n}\n")),(0,o.kt)("p",null,"The default value of ",(0,o.kt)("inlineCode",{parentName:"p"},"allowsBackgroundLocationUpdates")," is ",(0,o.kt)("inlineCode",{parentName:"p"},"false"),", and it can be disabled while the app is either in the foreground or the background. If the application requests ",(0,o.kt)("em",{parentName:"p"},"Always")," location authorization, be sure to check that ",(0,o.kt)("em",{parentName:"p"},"Always")," location authorization has not been granted before setting ",(0,o.kt)("inlineCode",{parentName:"p"},"allowsBackgroundLocationUpdates")," to ",(0,o.kt)("inlineCode",{parentName:"p"},"false"),", as setting the value to ",(0,o.kt)("inlineCode",{parentName:"p"},"false")," will prevent the app from accessing location from the background."),(0,o.kt)("h2",{id:"background-location-use-cases"},"Background location use cases"),(0,o.kt)("p",null,"It may be beneficial to switch the background location usage indicator on and off during app operation to maximise location data availability during mission-critical flows."),(0,o.kt)("p",null,"For example:\xa0"),(0,o.kt)("p",null,"On an app that handles ordering and pickup there may be value in starting Bluedot Geo-triggering on app start without the background location usage indicator enabled in order to power a marketing use case when the user grants ",(0,o.kt)("em",{parentName:"p"},"Always")," location authorization or is actively using the app. When the user places an order and there is greater necessity and value in collecting location data to maximise the likelihood the user is detected upon arrival at the collection point, the background location usage indicator should be enabled. Upon completion of the order and collection process, the background location usage indicator should be disabled, removing unauthorized background location data collection and the visible indicator."),(0,o.kt)("p",null,"Example steps to implement:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Start Geo-triggering without background location usage indicator enabled."),(0,o.kt)("li",{parentName:"ol"},"User places an order."),(0,o.kt)("li",{parentName:"ol"},"Enable background location usage indicator."),(0,o.kt)("li",{parentName:"ol"},"User travels to the pickup location."),(0,o.kt)("li",{parentName:"ol"},"Order is completed."),(0,o.kt)("li",{parentName:"ol"},"Disable background location usage indicator.")),(0,o.kt)("p",null,"Migration from BDPointBackgroundLocationEnabledForWhenInUseKey  "),(0,o.kt)("hr",null),(0,o.kt)("p",null,"The Bluedot iOS SDK also supports setting the background location usage indicator at build time. Setting a ",(0,o.kt)("inlineCode",{parentName:"p"},"BDPointBackgroundLocationEnabledForWhenInUseKey")," property in an app\u2019s ",(0,o.kt)("inlineCode",{parentName:"p"},"info.plist")," to ",(0,o.kt)("inlineCode",{parentName:"p"},"true")," will cause the Bluedot SDK to set the ",(0,o.kt)("inlineCode",{parentName:"p"},"allowsBackgroundLocationUpdates")," property setting to ",(0,o.kt)("inlineCode",{parentName:"p"},"true")," upon start. Enabling the background location usage indicator at runtime via this method is ",(0,o.kt)("strong",{parentName:"p"},"deprecated"),", and will be removed in a future release."),(0,o.kt)("p",null,"If the app was previously using ",(0,o.kt)("inlineCode",{parentName:"p"},"BDPointBackgroundLocationEnabledForWhenInUseKey")," to enable the background location usage indicator, please ensure the property is removed before using ",(0,o.kt)("inlineCode",{parentName:"p"},"BDLocationManager.instance().allowsBackgroundLocationUpdates"),"."),(0,o.kt)("p",null,"To migrate to the new method of enabling the background location usage indicator without a change in SDK or app functionality, simply remove the ",(0,o.kt)("inlineCode",{parentName:"p"},"BDPointBackgroundLocationEnabledForWhenInUseKey")," property and ensure ",(0,o.kt)("inlineCode",{parentName:"p"},"BDLocationManager.instance().allowsBackgroundLocationUpdates")," is set to ",(0,o.kt)("inlineCode",{parentName:"p"},"true")," prior to starting Geo-triggering or Tempo."))}p.isMDXComponent=!0},4302:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/iOS_allowsbackgroundlocationupdates-b598f73b0bc573c89215e5439563e471.png"},3934:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/ios-blue-bar-570b0ac37c27101e9ae5b00736c0d3e0.jpg"},1939:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/ios_background_mode-10385001cdfd008c9c77ede678abcf52.png"}}]);