"use strict";(self.webpackChunkdocs_test=self.webpackChunkdocs_test||[]).push([[4924],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>m});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=o.createContext({}),c=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},d=function(e){var t=c(e.components);return o.createElement(l.Provider,{value:t},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},g=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),u=c(n),g=a,m=u["".concat(l,".").concat(g)]||u[g]||p[g]||i;return n?o.createElement(m,r(r({ref:t},d),{},{components:n})):o.createElement(m,r({ref:t},d))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,r=new Array(i);r[0]=g;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:a,r[1]=s;for(var c=2;c<i;c++)r[c]=n[c];return o.createElement.apply(null,r)}return o.createElement.apply(null,n)}g.displayName="MDXCreateElement"},7531:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var o=n(7462),a=(n(7294),n(3905));const i={},r="Salesforce Android Integration",s={unversionedId:"Integrations/Salesforce/Mobile SDK Integration/Android",id:"Integrations/Salesforce/Mobile SDK Integration/Android",title:"Salesforce Android Integration",description:"Overview",source:"@site/docs/Integrations/Salesforce/Mobile SDK Integration/Android.md",sourceDirName:"Integrations/Salesforce/Mobile SDK Integration",slug:"/Integrations/Salesforce/Mobile SDK Integration/Android",permalink:"/documentation/Integrations/Salesforce/Mobile SDK Integration/Android",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"defaultSidebar",previous:{title:"Integrate the Point SDK",permalink:"/documentation/Integrations/Salesforce/Mobile SDK Integration/Overview"},next:{title:"Salesforce iOS Integration",permalink:"/documentation/Integrations/Salesforce/Mobile SDK Integration/iOS"}},l={},c=[{value:"Overview",id:"overview",level:2},{value:"Salesforce Marketing Cloud Android SDK Integration",id:"salesforce-marketing-cloud-android-sdk-integration",level:2},{value:"Bluedot Point SDK Integration",id:"bluedot-point-sdk-integration",level:2},{value:"Requirements",id:"requirements",level:3},{value:"Pass Salesforce Marketing Cloud Contact Key into Bluedot",id:"pass-salesforce-marketing-cloud-contact-key-into-bluedot",level:3},{value:"<strong>GitHub Sample Project</strong>",id:"github-sample-project",level:2}],d={toc:c},u="wrapper";function p(e){let{components:t,...i}=e;return(0,a.kt)(u,(0,o.Z)({},d,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"salesforce-android-integration"},"Salesforce Android Integration"),(0,a.kt)("h2",{id:"overview"},"Overview"),(0,a.kt)("p",null,"This documentation describes the steps required to integrate the Bluedot Point Android SDK and Marketing Cloud Android SDK into an Android App."),(0,a.kt)("h2",{id:"salesforce-marketing-cloud-android-sdk-integration"},"Salesforce Marketing Cloud Android SDK Integration"),(0,a.kt)("p",null,"1","."," Add the following repositories and dependencies to your Project\u2019s\xa0",(0,a.kt)("inlineCode",{parentName:"p"},"build.gradle"),"\xa0file:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-gradle"},"...\nallprojects {\n    repositories {\n        maven { url \"http://salesforce-marketingcloud.github.io/JB4A-SDK-Android/repository\" }\n    }\n}\n...\ndependencies { \n    ...\n    classpath 'com.google.gms:google-services:4.0.1'\n}\n")),(0,a.kt)("p",null,"2.\xa0 Add the following plugin and dependencies to your application\u2019s\xa0",(0,a.kt)("inlineCode",{parentName:"p"},"build.gradle"),"\xa0file:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-gradle"},"dependencies { \n    ... \n    implementation ('com.salesforce.marketingcloud:marketingcloudsdk:6.1.0') { \n         exclude module: 'play-services-location' //remove to use Geofence or Proximity messaging } \n    implementation 'com.google.android.gms:play-services-location:16.0.0'\n    api 'com.google.firebase:firebase-messaging:17.4.0'\n    api 'com.google.firebase:firebase-core:16.0.8'\n}\napply plugin: 'com.google.gms.google-services'\n")),(0,a.kt)("p",null,"3.\xa0 Add ",(0,a.kt)("inlineCode",{parentName:"p"},"google-services.json")," obtained from Firebase test project in your app as below:"),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(7253).Z,width:"254",height:"300"})),(0,a.kt)("p",null,"The following code example demonstrates starting the Marketing Cloud SDK as well as\xa0obtaining the\xa0",(0,a.kt)("inlineCode",{parentName:"p"},"salesforceContactKey"),"\xa0or setting the",(0,a.kt)("inlineCode",{parentName:"p"},"salesforceContactKey"),"\xa0if not assigned yet. More information on how to get AppID, Access Token and MID can be found ",(0,a.kt)("a",{parentName:"p",href:"http://salesforce-marketingcloud.github.io/JB4A-SDK-Android/create-apps/create-apps-overview.html#finding-your-marketing-cloud-application-configuration-data"},"here")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'public class MainApplication extends Application implements MarketingCloudSdk.InitializationListener {\n    private String salesforceContactKey;\n    private String app_id="";           //From Marketing Cloud App details\n    private String access_token="";     //From Marketing Cloud App details\n    private String mID = \u201c\u201d;            // MID from Firebase setup\n    private String fcm_id="";\n    private void initCloudMobilePushSDK() {\n        MarketingCloudSdk.init((this, MarketingCloudConfig.builder()\n            .setApplicationId(app_id)\n            .setAccessToken(access_token)\n            .setSenderId(fcm_id)\n            .setMarketingCloudServerUrl(getString(R.string.marketing_cloud_url))   //Cloud Marketing URL\n            .setMid(mID)\n            .setNotificationCustomizationOptions(\n                        NotificationCustomizationOptions.create(R.mipmap.ic_launcher, null,\n                              new com.salesforce.marketingcloud.notifications.NotificationManager.NotificationChannelIdProvider() {\n                              @Override @NonNull \n                               public String getNotificationChannelId(@NonNull Context context,@NonNull NotificationMessage notificationMessage) {\n                                     // Whatever custom logic required to determine which channel should be used for the message.\n                                     return CHANNEL_ID;\n                               }\n                })).build((Context) this), this));\n    }\n\n@Override\npublic void complete(@NonNull InitializationStatus status) {\n\nif (status.status() == InitializationStatus.Status.SUCCESS) {\n    logInfo("Marketing Cloud SDK started");\n    salesforceContactKey = MarketingCloudSdk.getInstance().getRegistrationManager().getContactKey();\n    if (salesforceContactKey == null || salesforceContactKey.length() == 0) {\n        salesforceContactKey = UUID.randomUUID().toString();\n        MarketingCloudSdk.getInstance().getRegistrationManager().edit().setContactKey(salesforceContactKey).commit();\n    }\n\n    } else if (status.status() == InitializationStatus.Status.COMPLETED_WITH_DEGRADED_FUNCTIONALITY) {\n        // While the SDK is usable, something happened during init that you should address.\n       // This could include:\n\n      //Google play services encountered a recoverable error\n\n     /* The user had previously provided the location permission, but it has now been revoked.\n     Geofence messages have been disabled. You will need to request the location\n     permission again and re-enable Geofence messaging again. */\n\n     /* Google Play Services attempted to update your SSL providers but failed. It should be assumed that\n     all network communications will fallback to TLS1.0.\n     */\n     } else if (status.status() == InitializationStatus.Status.FAILED) {\n         logInfo("Marketing Cloud SDK error: " + status.toString());\n     } else {\n         logInfo("Marketing Cloud SDK : Unknown error");\n     }\n   }\n    ...\n}\n')),(0,a.kt)("p",null,"The full documentation on Marketing Cloud SDK integration; if required at any point; is available\xa0",(0,a.kt)("a",{parentName:"p",href:"https://salesforce-marketingcloud.github.io/JB4A-SDK-Android/sdk-implementation/implement-sdk-google.html"},"here"),"."),(0,a.kt)("h2",{id:"bluedot-point-sdk-integration"},"Bluedot Point SDK Integration"),(0,a.kt)("h3",{id:"requirements"},"Requirements"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Minimum Android OS Version \u2013 4.0 Ice Cream Sandwich (API 14) and above."),(0,a.kt)("li",{parentName:"ul"},"Active mobile data or a Wi-Fi connection."),(0,a.kt)("li",{parentName:"ul"},"Location services must be turned on with the device allowing location updates from both GPS and network.")),(0,a.kt)("h3",{id:"pass-salesforce-marketing-cloud-contact-key-into-bluedot"},"Pass Salesforce Marketing Cloud Contact Key into Bluedot"),(0,a.kt)("p",null,"To trigger Bluedot events in Salesforce Marketing Cloud, please ensure that the Contact Key is passed into Bluedot via the ",(0,a.kt)("inlineCode",{parentName:"p"},"CustomKey"),"\xa0field with ",(0,a.kt)("inlineCode",{parentName:"p"},"ServiceManager.setCustomEventMetaData()"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'@Override\npublic void onBlueDotPointServiceStartedSuccess() {\n    mServiceManager.subscribeForApplicationNotification(this);\n    Map<String, String> metaData = new HashMap<>();\n    String salesforceContactKey = MarketingCloudSdk.getInstance().getRegistrationManager().getContactKey();\n    metaData.put("ContactKey", salesforceContactKey);\n    mServiceManager.setCustomEventMetaData(metaData);\n\n    logInfo("BD SDK started & Contact Key set as "+salesforceContactKey);\n }\n')),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"The custom event metadata is not persisted across SDK sessions. If the SDK is logged out the custom event metadata is cleared by the SDK. We suggest setting the custom data every time the SDK is authenticated in the app."),(0,a.kt)("p",{parentName:"admonition"},"More information on best practices of setting and using custom event metadata can be found ",(0,a.kt)("a",{parentName:"p",href:"/documentation/Custom%20Event%20Metadata"},"here"),".")),(0,a.kt)("h2",{id:"github-sample-project"},(0,a.kt)("strong",{parentName:"h2"},"GitHub Sample Project")),(0,a.kt)("p",null,"A sample project which demonstrates the integration of\xa0Marketing Cloud SDK and Bluedot Point\xa0SDK is available on\xa0",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("a",{parentName:"strong",href:"https://github.com/Bluedot-Innovation/Salesforce-Simple-Integration-Demo-Android"},"GitHub")),"."))}p.isMDXComponent=!0},7253:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/salesforce-android-google-services-28efaeec2cfa7bfa2282e708e7517743.png"}}]);